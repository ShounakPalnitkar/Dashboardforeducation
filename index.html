import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Configure style
plt.style.use('seaborn-whitegrid')
sns.set_palette("husl")

# Create a figure with subplots
fig = plt.figure(figsize=(20, 25))
fig.suptitle('Chronic Kidney Disease (CKD) Educational Dashboard', fontsize=18, y=0.98)

# -----------------------------------------------
# 1. CKD Progression (GFR Decline)
# -----------------------------------------------
ax1 = plt.subplot(3, 3, 1)
ax1.set_title('1. Kidney Function Decline (GFR Over Time)', pad=20)

# Simulate GFR trend (no actual data)
years = np.arange(0, 15)
gfr = [100, 95, 85, 70, 50, 35, 20, 15, 10, 8, 6, 5, 4, 3, 2]

ax1.plot(years, gfr, linestyle='--', marker='o', color='black')
ax1.set_xlabel('Years')
ax1.set_ylabel('GFR (mL/min/1.73mÂ²)')
ax1.axhspan(90, 120, facecolor='green', alpha=0.1, label='Normal')
ax1.axhspan(15, 90, facecolor='yellow', alpha=0.1)
ax1.axhspan(0, 15, facecolor='red', alpha=0.1)

# Annotations
ax1.text(10, 100, 'CKD Stage 1-2', fontsize=9)
ax1.text(5, 40, 'Stage 3-4 (Irreversible Damage)', fontsize=9)
ax1.text(2, 10, 'Stage 5 (Kidney Failure)', fontsize=9)

# -----------------------------------------------
# 2. Causes of CKD (Pie Chart)
# -----------------------------------------------
ax2 = plt.subplot(3, 3, 2)
ax2.set_title('2. Leading Causes of CKD', pad=20)

labels = ['Diabetes (45%)', 'Hypertension (30%)', 'Glomerulonephritis (15%)', 'Other (10%)']
sizes = [45, 30, 15, 10]
colors = ['#ff9999', '#66b3ff', '#99ff99', '#c2c2f0']

ax2.pie(sizes, labels=labels, colors=colors, autopct='%1.1f%%', startangle=90)
ax2.axis('equal')

# -----------------------------------------------
# 3. Risk Factor Impact (Bar Chart)
# -----------------------------------------------
ax3 = plt.subplot(3, 3, 3)
ax3.set_title('3. Modifiable vs. Non-Modifiable Risks', pad=20)

categories = ['Smoking', 'Obesity', 'Uncontrolled Diabetes', 'Age >60', 'Family History', 'Ethnicity']
types = ['Modifiable', 'Modifiable', 'Modifiable', 'Non-Modifiable', 'Non-Modifiable', 'Non-Modifiable']

sns.barplot(x=categories, y=[1]*6, hue=types, dodge=False, ax=ax3)
ax3.set_ylabel('')
ax3.set_yticks([])
ax3.legend(title='Risk Type')

# -----------------------------------------------
# 4. Symptom Progression (Heatmap)
# -----------------------------------------------
ax4 = plt.subplot(3, 3, 4)
ax4.set_title('4. Symptoms by CKD Stage', pad=20)

symptoms = ['Fatigue', 'Edema', 'Nausea', 'Shortness of Breath']
stages = ['Stage 1', 'Stage 2', 'Stage 3', 'Stage 4', 'Stage 5']

# Create "severity" matrix (hypothetical for education)
data = np.array([
    [0, 0, 1, 2, 3],  # Fatigue
    [0, 0, 1, 2, 3],  # Edema
    [0, 0, 0, 1, 3],  # Nausea
    [0, 0, 0, 1, 3]   # Shortness of Breath
])

sns.heatmap(data, annot=True, xticklabels=stages, yticklabels=symptoms, cmap='YlOrRd', ax=ax4)
ax4.set_xlabel('CKD Stage')

# -----------------------------------------------
# 5. Lab Markers (Parallel Coordinates)
# -----------------------------------------------
ax5 = plt.subplot(3, 3, 5)
ax5.set_title('5. Key Lab Markers in CKD', pad=20)

labs = ['Creatinine', 'BUN', 'Potassium', 'Albuminuria']
ax5.set_xticks(range(len(labs)))
ax5.set_xticklabels(labs)

# Add reference lines (no data)
ax5.hlines(1, 0, 3, colors='green', linestyles='dashed', label='Normal')
ax5.hlines(3, 0, 3, colors='red', linestyles='dashed', label='CKD Alert')
ax5.text(0.5, 3.5, 'Creatinine >1.2 mg/dL\nAlbuminuria >300 mg/day', fontsize=9)

# -----------------------------------------------
# 6. CKD Stages (Gantt Chart)
# -----------------------------------------------
ax6 = plt.subplot(3, 3, 6)
ax6.set_title('6. Stages of CKD', pad=20)

stages = ['Stage 1', 'Stage 2', 'Stage 3', 'Stage 4', 'Stage 5']
colors = ['#2ecc71', '#f1c40f', '#e67e22', '#e74c3c', '#c0392b']

for i, stage in enumerate(stages):
    ax6.barh(stage, width=3, left=i*2, color=colors[i])

ax6.set_xlabel('Progression Over Time')
ax6.set_xticks([])

# -----------------------------------------------
# 7. Treatment Pathways (Flowchart)
# -----------------------------------------------
ax7 = plt.subplot(3, 3, 7)
ax7.set_title('7. Treatment Pathways', pad=20)
ax7.axis('off')

# Text-based flowchart (no data)
flowchart_text = """
Stage 1-2:
- Lifestyle Changes
- Blood Pressure Control

Stage 3-4:
- ACE Inhibitors
- SGLT2 Inhibitors

Stage 5:
- Dialysis
- Transplant
"""
ax7.text(0.1, 0.5, flowchart_text, fontsize=11, va='center')

# -----------------------------------------------
# 8. Global Prevalence (Simplified Map)
# -----------------------------------------------
ax8 = plt.subplot(3, 3, 8)
ax8.set_title('8. Global Prevalence', pad=20)
ax8.axis('off')

# Text-based representation
ax8.text(0.1, 0.7, 'High Prevalence:\n- USA\n- India\n- China', fontsize=11)
ax8.text(0.1, 0.3, '15% of adults worldwide\nhave CKD', fontsize=11)

# -----------------------------------------------
# 9. Prevention Strategies (Infographic)
# -----------------------------------------------
ax9 = plt.subplot(3, 3, 9)
ax9.set_title('9. Prevention Strategies', pad=20)
ax9.axis('off')

prevention_text = """
- Control Blood Sugar (HbA1c <7%)
- BP <130/80 mmHg
- Low-Salt Diet
- Avoid NSAIDs
"""
ax9.text(0.1, 0.5, prevention_text, fontsize=11, va='center')

# Adjust layout
plt.tight_layout(rect=[0, 0, 1, 0.96]))
plt.show()
